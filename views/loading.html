{{template "layout/start"}}
<div class="hero min-h-screen bg-base-200">
  <div class="hero-content text-center">
    <div class="max-w-md">
      <div class="loading loading-spinner loading-lg text-primary mb-8"></div>
      <h1 class="text-5xl font-bold mb-4">Starting Workspace</h1>
      <p class="py-6">
        Your containerized development environment is being prepared. This may take a few moments...
      </p>
      
      <div class="stats shadow">
        <div class="stat">
          <div class="stat-figure text-primary">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
          </div>
          <div class="stat-title">Status</div>
          <div class="stat-value text-primary">Setting Up</div>
          <div class="stat-desc">Docker container</div>
        </div>
      </div>
      
      <div class="mt-8">
        <progress class="progress progress-primary w-full"></progress>
        <p class="text-sm text-base-content/70 mt-2">
          <span id="status-text">Initializing VS Code environment...</span>
        </p>
      </div>
      
      <div class="mt-6 space-y-2 text-sm text-base-content/60">
        <p>✓ Pulling Docker image</p>
        <p>✓ Creating container</p>
        <p class="loading loading-dots loading-sm">Installing VS Code extensions</p>
        <p class="opacity-50">⏳ Starting workspace server</p>
        <p class="opacity-50">⏳ Ready to code</p>
      </div>
    </div>
  </div>
</div>

<script>
// Auto-refresh the page every 3 seconds to check if workspace is ready
let refreshCount = 0;
const maxRefreshes = 60; // Stop after 3 minutes (60 * 3 seconds)

function refreshPage() {
  refreshCount++;
  
  if (refreshCount >= maxRefreshes) {
    document.getElementById('status-text').textContent = 'Workspace setup is taking longer than expected. Please try again.';
    return;
  }
  
  // Update status text based on time elapsed
  const elapsed = refreshCount * 3;
  if (elapsed < 30) {
    document.getElementById('status-text').textContent = 'Initializing VS Code environment...';
  } else if (elapsed < 60) {
    document.getElementById('status-text').textContent = 'Installing extensions and tools...';
  } else if (elapsed < 120) {
    document.getElementById('status-text').textContent = 'Starting workspace server...';
  } else {
    document.getElementById('status-text').textContent = 'Almost ready...';
  }
  
  // Refresh the page
  window.location.reload();
}

// Start the refresh timer
setTimeout(refreshPage, 3000);
</script>
{{template "layout/end"}}
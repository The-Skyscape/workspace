{{template "layout/start"}}
{{with $repo := repos.CurrentRepo}}
{{template "repo-breadcrumbs.html" .}}

{{template "repo-header.html" .}}

{{template "repo-tabs.html" repos.CurrentRepo}}

<!-- Activity Page -->
<div class="container mx-auto px-4 py-6 max-w-4xl">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold">Repository Activity</h1>
    <p class="text-base-content/70 mt-2">Track all activities and events for this repository</p>
  </div>

  <!-- Activities List -->
  <div class="card bg-base-100 shadow-lg border border-base-300">
    <div class="card-body">
      <div class="flex flex-col gap-1.5" id="activities-list">
        {{with repos.RepoActivities}}
        {{if .}}
        {{range .}}
        <div class="group flex items-center gap-3 px-2 py-2 rounded-lg transition-colors hover:bg-base-200/50">
          <!-- Activity Icon with colored background -->
          <div class="flex-shrink-0">
            <div class="w-9 h-9 rounded-full flex items-center justify-center {{if eq .Type "repo_created"}}bg-primary/20 text-primary{{else if eq .Type "workspace_launched"}}bg-info/20 text-info{{else if eq .Type "action_created"}}bg-secondary/20 text-secondary{{else if eq .Type "action_run"}}bg-secondary/20 text-secondary{{else if eq .Type "issue_created"}}bg-warning/20 text-warning{{else if eq .Type "pr_created"}}bg-success/20 text-success{{else if eq .Type "file_created"}}bg-accent/20 text-accent{{else}}bg-base-300 text-base-content{{end}}">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                {{if eq .Type "repo_created"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
                {{else if eq .Type "workspace_launched"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                {{else if eq .Type "action_created"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                {{else if eq .Type "action_run"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
                {{else if eq .Type "issue_created"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                {{else if eq .Type "pr_created"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                {{else if eq .Type "file_created"}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                {{else}}
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                {{end}}
              </svg>
            </div>
          </div>
          <!-- Activity Details -->
          <div class="flex-1 min-w-0">
            <div class="flex items-center justify-between">
              <p class="text-sm font-medium truncate">{{.Title}}</p>
              {{if eq .Type "repo_created"}}
              <span class="badge badge-primary badge-soft badge-xs">New Repo</span>
              {{else if eq .Type "workspace_launched"}}
              <span class="badge badge-info badge-soft badge-xs">Workspace</span>
              {{else if eq .Type "action_created"}}
              <span class="badge badge-secondary badge-soft badge-xs">Action</span>
              {{else if eq .Type "action_run"}}
              <span class="badge badge-secondary badge-soft badge-xs">Run</span>
              {{else if eq .Type "issue_created"}}
              <span class="badge badge-warning badge-soft badge-xs">Issue</span>
              {{else if eq .Type "pr_created"}}
              <span class="badge badge-success badge-soft badge-xs">Pull Request</span>
              {{else if eq .Type "file_created"}}
              <span class="badge badge-accent badge-soft badge-xs">File</span>
              {{end}}
            </div>
            <p class="text-xs text-base-content/50 mt-1">{{.CreatedAt.Format "Jan 2, 3:04 PM"}}</p>
          </div>
        </div>
        {{end}}
        {{else}}
        <div class="text-center py-8 text-base-content/50">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-sm">No activity yet</p>
        </div>
        {{end}}
        {{else}}
        <div class="text-center py-8 text-base-content/50">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-sm">No activity yet</p>
        </div>
        {{end}}
      </div>
    </div>
  </div>

  <!-- Back to Repository -->
  <div class="mt-6 text-center">
    <a href="{{host}}/repos/{{$repo.ID}}" class="btn btn-ghost" hx-boost="true">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
      </svg>
      Back to Repository
    </a>
  </div>
</div>

{{else}}
<div class="text-center py-16">
  <h2 class="text-2xl font-bold mb-4 text-error">Repository Not Found</h2>
  <p class="text-base-content/70 mb-6">The repository you're looking for doesn't exist or you don't have access to it.</p>
  <a href="{{host}}/repos" class="btn btn-primary">Back to Repositories</a>
</div>
{{end}}
{{template "layout/end"}}
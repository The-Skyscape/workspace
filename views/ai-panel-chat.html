<!-- AI Chat Tab Content -->
<div class="flex flex-col h-full">
    <!-- Search Bar -->
    <div class="pb-4 border-b border-base-300">
        <div class="relative">
            <input type="search" 
                   placeholder="Search conversations..." 
                   class="input input-bordered input-sm w-full pl-10"
                   hx-get="{{host}}/ai/panel?tab=chat"
                   hx-trigger="input delay:300ms, search"
                   hx-target="#conversation-list"
                   hx-indicator="#search-spinner"
                   name="q">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-base-content/50" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <span id="search-spinner" class="htmx-indicator absolute right-3 top-1/2 transform -translate-y-1/2">
                <span class="loading loading-spinner loading-xs"></span>
            </span>
        </div>
    </div>

    <!-- Conversation List -->
    <div class="flex-1 overflow-y-auto mt-4">
        <div class="flex flex-col gap-2" id="conversation-list">
            {{if .}}
                {{range .}}
                <div class="card bg-base-100 border border-base-300 hover:border-primary/50 transition-all cursor-pointer"
                     hx-get="{{host}}/ai/chat/{{.ID}}"
                     hx-target="#ai-panel-content"
                     hx-swap="innerHTML">
                    <div class="card-body p-3">
                        <div class="flex items-start justify-between gap-3">
                            <div class="flex-1 min-w-0">
                                <h4 class="font-semibold text-sm truncate">{{.Title}}</h4>
                                <p class="text-xs text-base-content/60 truncate mt-1">{{.LastMessage}}</p>
                            </div>
                            <span class="text-xs text-base-content/50 whitespace-nowrap">
                                {{.UpdatedAt.Format "Jan 2, 3:04 PM"}}
                            </span>
                        </div>
                        <div class="flex items-center gap-2 mt-2">
                            <span class="badge badge-xs">{{.MessageCount}} messages</span>
                            {{if eq .Model "gpt-oss"}}
                                <span class="badge badge-xs badge-primary">Llama</span>
                            {{else}}
                                <span class="badge badge-xs badge-secondary">{{.Model}}</span>
                            {{end}}
                        </div>
                    </div>
                </div>
                {{end}}
            {{else}}
                <div class="text-center py-8">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-base-content/30 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    <p class="text-base-content/50">No conversations yet</p>
                    <p class="text-xs text-base-content/30 mt-2">Start a new chat to begin</p>
                </div>
            {{end}}
        </div>
    </div>
</div>
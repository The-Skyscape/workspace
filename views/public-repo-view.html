{{template "layout/start"}}
{{with home.CurrentRepo}}
<div class="breadcrumbs text-sm mb-6">
  <ul>
    <li><a href="{{host}}/">Home</a></li>
    <li>{{.Name}}</li>
  </ul>
</div>

<!-- Repository Header -->
<div class="flex items-center justify-between mb-8">
  <div class="flex items-center space-x-4">
    <div class="avatar placeholder">
      <div class="bg-primary text-primary-content rounded w-16 h-16">
        <span class="text-xl">{{printf "%.2s" .Name}}</span>
      </div>
    </div>
    <div>
      <h1 class="text-3xl font-bold">{{.Name}}</h1>
      <div class="flex items-center space-x-4 text-sm text-base-content/70">
        <div class="flex items-center space-x-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>{{.Visibility}} repository</span>
        </div>
        <div class="flex items-center space-x-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>Updated {{.UpdatedAt.Format "Jan 2, 2006"}}</span>
        </div>
      </div>
      {{if .Description}}
      <p class="text-base-content/70 mt-2">{{.Description}}</p>
      {{end}}
    </div>
  </div>

  <div class="flex items-center space-x-2">
    <a href="{{host}}/signup" class="btn btn-primary">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z" />
      </svg>
      Sign Up to Fork
    </a>
  </div>
</div>

<!-- Public Navigation Tabs -->
<div class="tabs tabs-bordered mb-6">
  <a href="{{host}}/public/repos/{{.ID}}" class="tab tab-active">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
    </svg>
    Code
  </a>
  <a href="{{host}}/public/repos/{{.ID}}/issues" class="tab">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
    </svg>
    Issues ({{len (home.PublicRepoIssues)}})
  </a>
</div>

<!-- Main Content -->
<div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

  <!-- Repository Content -->
  <div class="lg:col-span-3">
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <h2 class="card-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6h-8V5z" />
          </svg>
          Repository Contents
        </h2>

        <!-- Clone Information -->
        <div class="bg-base-200 rounded-lg p-4 mb-6">
          <h3 class="font-semibold mb-2">Clone this repository</h3>
          <div class="flex items-center space-x-2">
            <code class="flex-1 p-2 bg-base-300 rounded text-sm">git clone {{repos.HostURL}}/repo/{{.ID}}</code>
            <button class="btn btn-ghost btn-sm"
                    _="on click writeText('git clone {{repos.HostURL}}/repo/{{.ID}}') to navigator.clipboard then add .btn-success to me then remove .btn-success from me after 2s">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            </button>
          </div>
          <p class="text-sm text-base-content/70 mt-2">
            <a href="{{host}}/signin" class="link">Sign in</a> or <a href="{{host}}/signup" class="link">create an account</a> to get full Git access
          </p>
        </div>

        <!-- File Browser Placeholder -->
        <div class="text-center py-12 border-2 border-dashed border-base-300 rounded-lg">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto mb-4 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6h-8V5z" />
          </svg>
          <h3 class="text-lg font-semibold mb-2">Repository Browser</h3>
          <p class="text-base-content/70 mb-4">Sign up for full access to browse files, view history, and more</p>
          <a href="{{host}}/signup" class="btn btn-primary">Create Account</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Sidebar -->
  <div class="flex flex-col gap-6">

    <!-- Repository Info -->
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <h3 class="card-title text-lg">About</h3>
        {{if .Description}}
        <p class="text-base-content/70">{{.Description}}</p>
        {{else}}
        <p class="text-base-content/70">No description provided</p>
        {{end}}

        <div class="divider"></div>

        <div class="flex flex-col gap-3">
          <div class="flex items-center justify-between">
            <span class="text-sm text-base-content/70">Visibility</span>
            <div class="badge badge-outline">{{.Visibility}}</div>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-sm text-base-content/70">Created</span>
            <span class="text-sm">{{.CreatedAt.Format "Jan 2, 2006"}}</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-sm text-base-content/70">Updated</span>
            <span class="text-sm">{{.UpdatedAt.Format "Jan 2, 2006"}}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Owner Info -->
    {{with home.RepoOwnerInfo}}
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <h3 class="card-title text-lg">Owner</h3>
        <div class="flex items-center space-x-3">
          <div class="avatar">
            <div class="w-10 rounded-full">
              <img src="{{.Avatar}}" alt="{{.Name}}" />
            </div>
          </div>
          <div>
            <div class="font-medium">{{.Name}}</div>
          </div>
        </div>
      </div>
    </div>
    {{end}}

    <!-- Call to Action -->
    <div class="card bg-primary text-primary-content shadow-xl">
      <div class="card-body text-center">
        <h3 class="card-title justify-center">Join Skyscape</h3>
        <p class="text-sm">Get full access to repositories, workspaces, and AI tools</p>
        <div class="card-actions justify-center mt-4">
          <a href="{{host}}/signup" class="btn btn-secondary btn-sm">Sign Up Free</a>
        </div>
      </div>
    </div>

  </div>
</div>
{{else}}
<!-- Repository Not Found -->
<div class="text-center py-16">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 mx-auto mb-6 text-base-content/30" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
  </svg>
  <h2 class="text-2xl font-bold mb-4">Repository not found</h2>
  <p class="text-base-content/70 mb-6">This repository doesn't exist or isn't public</p>
  <a href="{{host}}/" class="btn btn-primary">Back to Home</a>
</div>
{{end}}

{{template "layout/end"}}
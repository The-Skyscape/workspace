{{template "layout/start"}}

<!-- Settings Header -->
<div class="navbar bg-base-100 border-b border-base-300">
  <div class="container mx-auto max-w-7xl px-4">
    <div class="flex-1">
      <h1 class="text-2xl font-bold">System Settings</h1>
      <p class="text-base-content/70">Configure your Skyscape instance</p>
    </div>
  </div>
</div>

<!-- Settings Container -->
<div class="container mx-auto px-4 py-6 max-w-7xl">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    
    {{template "settings-nav.html"}}

    <!-- Main Monitoring Content -->
    <div class="lg:col-span-2">
      <!-- Alert Banner -->
      <div id="alerts-container" hx-get="{{host}}/monitoring/partial/alerts" hx-trigger="every 5s" hx-swap="innerHTML" class="mb-4">
        {{template "monitoring-alerts.html" .}}
      </div>

      <!-- Main Stats Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <!-- CPU Card -->
        <div class="card bg-base-100 shadow-sm border border-base-300" id="cpu-card" 
             hx-get="{{host}}/monitoring/partial/cpu" hx-trigger="every 2s" hx-swap="innerHTML">
          {{template "monitoring-cpu.html" .}}
        </div>

        <!-- Memory Card -->
        <div class="card bg-base-100 shadow-sm border border-base-300" id="memory-card"
             hx-get="{{host}}/monitoring/partial/memory" hx-trigger="every 2s" hx-swap="innerHTML">
          {{template "monitoring-memory.html" .}}
        </div>

        <!-- Disk Card -->
        <div class="card bg-base-100 shadow-sm border border-base-300" id="disk-card"
             hx-get="{{host}}/monitoring/partial/disk" hx-trigger="every 5s" hx-swap="innerHTML">
          {{template "monitoring-disk.html" .}}
        </div>

        <!-- System Info Card -->
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body">
            <h3 class="card-title text-lg">System Info</h3>
            {{with monitoring.GetCurrentStats}}
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-base-content/70">CPU Cores</span>
                <span class="font-mono">{{.CPU.Cores}}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-base-content/70">Load Average</span>
                <span class="font-mono">{{printf "%.2f" .LoadAverage.Load1}}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-base-content/70">Processes</span>
                <span class="font-mono">{{.Processes.Total}}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-base-content/70">Running</span>
                <span class="font-mono">{{.Processes.Running}}</span>
              </div>
            </div>
            {{end}}
          </div>
        </div>
      </div>

      <!-- Docker Containers Section -->
      <div class="card bg-base-100 shadow-sm border border-base-300 mb-6">
        <div class="card-body">
          <h2 class="card-title">Docker Containers</h2>
          <div id="containers-table" hx-get="{{host}}/monitoring/partial/containers" hx-trigger="every 3s" hx-swap="innerHTML">
            {{template "monitoring-containers.html" .}}
          </div>
        </div>
      </div>

      <!-- Detailed Stats Section -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Network Stats -->
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body">
            <h3 class="card-title">Network Usage</h3>
            {{with monitoring.GetCurrentStats}}
            <div class="space-y-3">
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Bytes Received</span>
                  <span class="text-sm font-mono">{{monitoring.FormatBytes .Network.BytesRecv}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Bytes Sent</span>
                  <span class="text-sm font-mono">{{monitoring.FormatBytes .Network.BytesSent}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Packets Received</span>
                  <span class="text-sm font-mono">{{.Network.PacketsRecv}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Packets Sent</span>
                  <span class="text-sm font-mono">{{.Network.PacketsSent}}</span>
                </div>
              </div>
            </div>
            {{end}}
          </div>
        </div>

        <!-- Process Stats -->
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body">
            <h3 class="card-title">Process Statistics</h3>
            {{with monitoring.GetCurrentStats}}
            <div class="space-y-3">
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Total Processes</span>
                  <span class="text-sm font-mono">{{.Processes.Total}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Running</span>
                  <span class="text-sm font-mono text-success">{{.Processes.Running}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Sleeping</span>
                  <span class="text-sm font-mono">{{.Processes.Sleeping}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Stopped</span>
                  <span class="text-sm font-mono text-warning">{{.Processes.Stopped}}</span>
                </div>
              </div>
              <div>
                <div class="flex justify-between mb-1">
                  <span class="text-sm text-base-content/70">Zombie</span>
                  <span class="text-sm font-mono text-error">{{.Processes.Zombie}}</span>
                </div>
              </div>
            </div>
            {{end}}
          </div>
        </div>
      </div>

      <!-- Auto-refresh indicator -->
      <div class="mt-6 text-center text-sm text-base-content/50">
        <span class="inline-flex items-center gap-2">
          <span class="loading loading-ring loading-xs"></span>
          Auto-refreshing every 2 seconds
        </span>
      </div>
    </div>
  </div>
</div>

{{template "layout/end"}}